name: Stable

on:
  push: # for testing only
  schedule:
    # Run every 2 hours
    - cron: "0 */2 * * *"
  workflow_dispatch:  # manual trigger

jobs:
  tests:
    name: Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v5
      - uses: pypa/hatch@install
      - name: Download knowledge base
        run: |
          mkdir -p data
          curl -o data/kb.json https://cleanlab-public.s3.us-east-1.amazonaws.com/airline-agent/kb.json
      - name: Create vector database
        run: hatch run create-vector-database
      - run: hatch test -v